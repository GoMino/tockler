appId: 'ee.trimatech.tockler'
productName: 'Tockler'
asar: false
asarUnpack:
    - scripts
    - shared

npmRebuild: false

directories:
    output: 'packaged'
files:
    - 'dist-electron/**/*'
    - 'package.json'
    - 'shared/**/*'

publish:
    - github

mac:
    category: public.app-category.productivity
    hardenedRuntime: true
    gatekeeperAssess: false
    icon: build/icon.icns
    entitlements: './build/entitlements.mac.plist'
    entitlementsInherit: 'build/entitlements.mac.plist'
    asarUnpack: '**/*.node'
    darkModeSupport: true
    electronUpdaterCompatibility: '>=2.16.0'
    extendInfo:
        LSUIElement: 1
    target:
        - target: dmg
          arch:
              - x64
              - arm64
        - target: zip
          arch:
              - x64
              - arm64
    x64ArchFiles:
        - 'node_modules/active-win/bin/darwin-x64-*/active-win.node'
        - 'node_modules/better-sqlite3/build/Release/better_sqlite3.node'
        - 'node_modules/node-machine-id/build/Release/nodeMachineId.node'
    arm64ArchFiles:
        - 'node_modules/active-win/bin/darwin-arm64-*/active-win.node'
        - 'node_modules/better-sqlite3/build/Release/better_sqlite3.node'
        - 'node_modules/node-machine-id/build/Release/nodeMachineId.node'

mas:
    entitlements: './build/entitlements.mas.plist'
    entitlementsInherit: './build/entitlements.mas.plist'
    type: distribution
    provisioningProfile: embedded.provisionprofile
    #type: development
    #provisioningProfile: development.provisionprofile

win:
    artifactName: ${name}-${version}-portable-${os}-${arch}.${ext}
    electronUpdaterCompatibility: '>=2.16.0'
    target:
        - target: nsis
          arch:
              - x64
              - ia32
              - arm64
        - target: portable
          arch:
              - x64
              - ia32
              - arm64

nsis:
    artifactName: ${name}-${version}-setup-${os}-${arch}.${ext}
    oneClick: false
    allowToChangeInstallationDirectory: true
    differentialPackage: false
linux:
    category: Utility
    electronUpdaterCompatibility: '>=2.16.0'
    target:
        - AppImage
snap:
    confinement: devmode
    assumes:
        - common-data-dir
        - command-chain
    layout:
        /usr/bin/xprop:
            bind-file: $SNAP/xprop
        /usr/bin/xwininfo:
            bind-file: $SNAP/xwininfo

dmg:
    sign: false
protocols:
    name: Tockler
    schemes:
        - tockler
